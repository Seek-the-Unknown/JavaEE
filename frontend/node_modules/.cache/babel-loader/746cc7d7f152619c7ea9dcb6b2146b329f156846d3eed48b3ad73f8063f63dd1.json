{"ast":null,"code":"import axios from \"axios\";\nconst service = axios.create({\n  baseURL: \"http://localhost:8888/api\",\n  timeout: 10000\n});\n\n// 请求拦截器\nservice.interceptors.request.use(config => {\n  // ======== 确保这段逻辑存在且正确 ========\n  // 每次请求都尝试从 localStorage 获取用户信息\n  const userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\n  // 如果用户信息存在，就在请求头中添加 userId\n  if (userInfo && userInfo.id) {\n    config.headers[\"userId\"] = userInfo.id;\n  }\n  return config;\n}, error => {\n  console.log(error);\n  return Promise.reject(error);\n});\n\n// 响应拦截器 (保持不变)\nservice.interceptors.response.use(response => {\n  const res = response.data;\n  if (res.code !== 200) {\n    console.error(\"API Logic Error: \", res.message);\n    return Promise.reject(new Error(res.message || \"Error\"));\n  } else {\n    return res.data;\n  }\n}, error => {\n  console.log(\"err\" + error);\n  let message = \"发生未知错误\";\n  if (error.response) {\n    if (error.response.data && error.response.data.message) {\n      message = error.response.data.message;\n    } else {\n      switch (error.response.status) {\n        case 400:\n          message = \"请求参数错误\";\n          break;\n        case 401:\n          message = \"未授权，请登录\";\n          break;\n        case 403:\n          message = \"权限不足，拒绝访问\";\n          break;\n        case 404:\n          message = \"请求地址不存在\";\n          break;\n        case 500:\n          message = \"服务器内部错误\";\n          break;\n        default:\n          message = `连接错误 ${error.response.status}`;\n      }\n    }\n  } else if (error.message.includes(\"timeout\")) {\n    message = \"请求超时，请检查网络连接\";\n  }\n  return Promise.reject(new Error(message));\n});\nexport default service;","map":{"version":3,"names":["axios","service","create","baseURL","timeout","interceptors","request","use","config","userInfo","JSON","parse","localStorage","getItem","id","headers","error","console","log","Promise","reject","response","res","data","code","message","Error","status","includes"],"sources":["F:/Java_web_code/frontend/src/utils/request.js"],"sourcesContent":["import axios from \"axios\";\n\nconst service = axios.create({\n  baseURL: \"http://localhost:8888/api\",\n  timeout: 10000,\n});\n\n// 请求拦截器\nservice.interceptors.request.use(\n  (config) => {\n    // ======== 确保这段逻辑存在且正确 ========\n    // 每次请求都尝试从 localStorage 获取用户信息\n    const userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\n    // 如果用户信息存在，就在请求头中添加 userId\n    if (userInfo && userInfo.id) {\n      config.headers[\"userId\"] = userInfo.id;\n    }\n    return config;\n  },\n  (error) => {\n    console.log(error);\n    return Promise.reject(error);\n  }\n);\n\n// 响应拦截器 (保持不变)\nservice.interceptors.response.use(\n  (response) => {\n    const res = response.data;\n    if (res.code !== 200) {\n      console.error(\"API Logic Error: \", res.message);\n      return Promise.reject(new Error(res.message || \"Error\"));\n    } else {\n      return res.data;\n    }\n  },\n  (error) => {\n    console.log(\"err\" + error);\n    let message = \"发生未知错误\";\n\n    if (error.response) {\n      if (error.response.data && error.response.data.message) {\n        message = error.response.data.message;\n      } else {\n        switch (error.response.status) {\n          case 400:\n            message = \"请求参数错误\";\n            break;\n          case 401:\n            message = \"未授权，请登录\";\n            break;\n          case 403:\n            message = \"权限不足，拒绝访问\";\n            break;\n          case 404:\n            message = \"请求地址不存在\";\n            break;\n          case 500:\n            message = \"服务器内部错误\";\n            break;\n          default:\n            message = `连接错误 ${error.response.status}`;\n        }\n      }\n    } else if (error.message.includes(\"timeout\")) {\n      message = \"请求超时，请检查网络连接\";\n    }\n\n    return Promise.reject(new Error(message));\n  }\n);\n\nexport default service;\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,OAAO,GAAGD,KAAK,CAACE,MAAM,CAAC;EAC3BC,OAAO,EAAE,2BAA2B;EACpCC,OAAO,EAAE;AACX,CAAC,CAAC;;AAEF;AACAH,OAAO,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CAC7BC,MAAM,IAAK;EACV;EACA;EACA,MAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,CAAC;EAC7D;EACA,IAAIJ,QAAQ,IAAIA,QAAQ,CAACK,EAAE,EAAE;IAC3BN,MAAM,CAACO,OAAO,CAAC,QAAQ,CAAC,GAAGN,QAAQ,CAACK,EAAE;EACxC;EACA,OAAON,MAAM;AACf,CAAC,EACAQ,KAAK,IAAK;EACTC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;EAClB,OAAOG,OAAO,CAACC,MAAM,CAACJ,KAAK,CAAC;AAC9B,CACF,CAAC;;AAED;AACAf,OAAO,CAACI,YAAY,CAACgB,QAAQ,CAACd,GAAG,CAC9Bc,QAAQ,IAAK;EACZ,MAAMC,GAAG,GAAGD,QAAQ,CAACE,IAAI;EACzB,IAAID,GAAG,CAACE,IAAI,KAAK,GAAG,EAAE;IACpBP,OAAO,CAACD,KAAK,CAAC,mBAAmB,EAAEM,GAAG,CAACG,OAAO,CAAC;IAC/C,OAAON,OAAO,CAACC,MAAM,CAAC,IAAIM,KAAK,CAACJ,GAAG,CAACG,OAAO,IAAI,OAAO,CAAC,CAAC;EAC1D,CAAC,MAAM;IACL,OAAOH,GAAG,CAACC,IAAI;EACjB;AACF,CAAC,EACAP,KAAK,IAAK;EACTC,OAAO,CAACC,GAAG,CAAC,KAAK,GAAGF,KAAK,CAAC;EAC1B,IAAIS,OAAO,GAAG,QAAQ;EAEtB,IAAIT,KAAK,CAACK,QAAQ,EAAE;IAClB,IAAIL,KAAK,CAACK,QAAQ,CAACE,IAAI,IAAIP,KAAK,CAACK,QAAQ,CAACE,IAAI,CAACE,OAAO,EAAE;MACtDA,OAAO,GAAGT,KAAK,CAACK,QAAQ,CAACE,IAAI,CAACE,OAAO;IACvC,CAAC,MAAM;MACL,QAAQT,KAAK,CAACK,QAAQ,CAACM,MAAM;QAC3B,KAAK,GAAG;UACNF,OAAO,GAAG,QAAQ;UAClB;QACF,KAAK,GAAG;UACNA,OAAO,GAAG,SAAS;UACnB;QACF,KAAK,GAAG;UACNA,OAAO,GAAG,WAAW;UACrB;QACF,KAAK,GAAG;UACNA,OAAO,GAAG,SAAS;UACnB;QACF,KAAK,GAAG;UACNA,OAAO,GAAG,SAAS;UACnB;QACF;UACEA,OAAO,GAAG,QAAQT,KAAK,CAACK,QAAQ,CAACM,MAAM,EAAE;MAC7C;IACF;EACF,CAAC,MAAM,IAAIX,KAAK,CAACS,OAAO,CAACG,QAAQ,CAAC,SAAS,CAAC,EAAE;IAC5CH,OAAO,GAAG,cAAc;EAC1B;EAEA,OAAON,OAAO,CAACC,MAAM,CAAC,IAAIM,KAAK,CAACD,OAAO,CAAC,CAAC;AAC3C,CACF,CAAC;AAED,eAAexB,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}