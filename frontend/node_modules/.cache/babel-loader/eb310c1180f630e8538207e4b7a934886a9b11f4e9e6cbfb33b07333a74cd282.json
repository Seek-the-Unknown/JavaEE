{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport { useUserStore } from \"@/store/user\";\nimport { useRouter } from \"vue-router\"; // 导入 useRouter\nimport { ref, onMounted, watch } from \"vue\";\nimport { getVenueList, deleteVenue } from \"@/api/venue\"; // 导入 deleteVenue\n\nexport default {\n  __name: 'VenueListView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const {\n      isAdmin\n    } = useUserStore();\n    const router = useRouter(); // 定义 router\n\n    const venues = ref([]);\n    const loading = ref(true);\n    const searchQuery = ref(\"\");\n\n    // 管理员操作函数\n    const handleAddNew = () => {\n      router.push(\"/admin/venue/new\");\n    };\n    const handleEdit = id => {\n      router.push(`/admin/venue/edit/${id}`);\n    };\n    const handleDelete = async id => {\n      const venueToDelete = venues.value.find(v => v.id === id);\n      if (confirm(`您确定要删除场馆 \"${venueToDelete?.name}\" 吗？`)) {\n        try {\n          await deleteVenue(id);\n          venues.value = venues.value.filter(v => v.id !== id);\n        } catch (error) {\n          alert(\"删除失败: \" + error.message);\n        }\n      }\n    };\n    const fetchVenues = async query => {\n      try {\n        loading.value = true;\n        venues.value = await getVenueList(query);\n      } catch (error) {\n        console.error(error);\n      } finally {\n        loading.value = false;\n      }\n    };\n    let debounceTimer = null;\n    watch(searchQuery, newQuery => {\n      clearTimeout(debounceTimer);\n      debounceTimer = setTimeout(() => {\n        fetchVenues(newQuery);\n      }, 500);\n    });\n    onMounted(() => {\n      fetchVenues(\"\");\n    });\n    const __returned__ = {\n      isAdmin,\n      router,\n      venues,\n      loading,\n      searchQuery,\n      handleAddNew,\n      handleEdit,\n      handleDelete,\n      fetchVenues,\n      get debounceTimer() {\n        return debounceTimer;\n      },\n      set debounceTimer(v) {\n        debounceTimer = v;\n      },\n      get useUserStore() {\n        return useUserStore;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      ref,\n      onMounted,\n      watch,\n      get getVenueList() {\n        return getVenueList;\n      },\n      get deleteVenue() {\n        return deleteVenue;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["useUserStore","useRouter","ref","onMounted","watch","getVenueList","deleteVenue","isAdmin","router","venues","loading","searchQuery","handleAddNew","push","handleEdit","id","handleDelete","venueToDelete","value","find","v","confirm","name","filter","error","alert","message","fetchVenues","query","console","debounceTimer","newQuery","clearTimeout","setTimeout"],"sources":["F:/Java_web_code/frontend/src/views/VenueListView.vue"],"sourcesContent":["<template>\n  <div class=\"venue-list-page\">\n    <h1 class=\"page-title\">所有场馆</h1>\n    <div class=\"page-controls\">\n      <div class=\"search-bar\">\n        <i class=\"icon icon-search\"></i>\n        <input type=\"text\" placeholder=\"按名称搜索...\" v-model=\"searchQuery\" />\n      </div>\n      <!-- 管理员新增按钮，现在由 isAdmin 控制 -->\n      <button v-if=\"isAdmin\" @click=\"handleAddNew\" class=\"add-new-btn\">\n        新增场馆\n      </button>\n    </div>\n\n    <div v-if=\"loading\" class=\"loading\">加载中...</div>\n    <div v-else-if=\"venues.length === 0\" class=\"empty-state\">\n      未找到匹配的场馆。\n    </div>\n    <div v-else class=\"venue-grid\">\n      <div v-for=\"venue in venues\" :key=\"venue.id\" class=\"venue-card\">\n        <div\n          class=\"card-image\"\n          :style=\"{\n            backgroundImage: `url(${\n              venue.imageUrl || `https://picsum.photos/seed/${venue.id}/400/250`\n            })`,\n          }\"\n        >\n          <span class=\"type-tag\">{{ venue.type }}</span>\n        </div>\n        <div class=\"card-body\">\n          <h3 class=\"venue-name\">{{ venue.name }}</h3>\n          <p class=\"venue-description\">{{ venue.description || \"暂无描述\" }}</p>\n          <!-- 管理员编辑/删除按钮 -->\n          <div v-if=\"isAdmin\" class=\"admin-actions\">\n            <button @click=\"handleEdit(venue.id)\" class=\"edit-btn\">编辑</button>\n            <button @click=\"handleDelete(venue.id)\" class=\"delete-btn\">\n              删除\n            </button>\n          </div>\n        </div>\n        <div class=\"card-footer\">\n          <span class=\"price\">¥{{ venue.pricePerHour }}/小时</span>\n          <router-link :to=\"`/venue/${venue.id}`\" class=\"details-btn\"\n            >查看详情</router-link\n          >\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { useUserStore } from \"@/store/user\";\nimport { useRouter } from \"vue-router\"; // 导入 useRouter\nimport { ref, onMounted, watch } from \"vue\";\nimport { getVenueList, deleteVenue } from \"@/api/venue\"; // 导入 deleteVenue\n\nconst { isAdmin } = useUserStore();\nconst router = useRouter(); // 定义 router\n\nconst venues = ref([]);\nconst loading = ref(true);\nconst searchQuery = ref(\"\");\n\n// 管理员操作函数\nconst handleAddNew = () => {\n  router.push(\"/admin/venue/new\");\n};\nconst handleEdit = (id) => {\n  router.push(`/admin/venue/edit/${id}`);\n};\nconst handleDelete = async (id) => {\n  const venueToDelete = venues.value.find((v) => v.id === id);\n  if (confirm(`您确定要删除场馆 \"${venueToDelete?.name}\" 吗？`)) {\n    try {\n      await deleteVenue(id);\n      venues.value = venues.value.filter((v) => v.id !== id);\n    } catch (error) {\n      alert(\"删除失败: \" + error.message);\n    }\n  }\n};\n\nconst fetchVenues = async (query) => {\n  try {\n    loading.value = true;\n    venues.value = await getVenueList(query);\n  } catch (error) {\n    console.error(error);\n  } finally {\n    loading.value = false;\n  }\n};\n\nlet debounceTimer = null;\nwatch(searchQuery, (newQuery) => {\n  clearTimeout(debounceTimer);\n  debounceTimer = setTimeout(() => {\n    fetchVenues(newQuery);\n  }, 500);\n});\n\nonMounted(() => {\n  fetchVenues(\"\");\n});\n</script>\n\n<style scoped>\n/* 引入新的图标CSS */\n@import url(\"@/assets/icons.css\");\n.icon-search {\n  mask-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'%3E%3C/circle%3E%3Cline x1='21' y1='21' x2='16.65' y2='16.65'%3E%3C/line%3E%3C/svg%3E\");\n}\n\n.page-controls {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 32px;\n}\n.search-bar {\n  position: relative;\n}\n.search-bar .icon {\n  position: absolute;\n  left: 16px;\n  top: 50%;\n  transform: translateY(-50%);\n  color: var(--text-secondary);\n}\n.search-bar input {\n  padding: 12px 16px 12px 48px;\n  border: 1px solid var(--border-color);\n  border-radius: 8px;\n  width: 300px;\n  font-size: 14px;\n}\n.add-new-btn {\n  background: var(--primary-color);\n  color: white;\n  border: none;\n  padding: 12px 20px;\n  border-radius: 8px;\n  cursor: pointer;\n  font-weight: 500;\n}\n\n.venue-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n  gap: 32px;\n}\n.venue-card {\n  background: var(--card-bg);\n  border-radius: var(--border-radius);\n  box-shadow: 0 4px 6px -1px var(--shadow-color),\n    0 2px 4px -2px var(--shadow-color);\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  transition: transform 0.2s ease, box-shadow 0.2s ease;\n}\n.venue-card:hover {\n  transform: translateY(-4px);\n  box-shadow: 0 10px 15px -3px var(--shadow-color),\n    0 4px 6px -4px var(--shadow-color);\n}\n.card-image {\n  height: 180px;\n  background-size: cover;\n  background-position: center;\n  position: relative;\n}\n.type-tag {\n  position: absolute;\n  top: 12px;\n  right: 12px;\n  background: rgba(0, 0, 0, 0.4);\n  color: white;\n  padding: 4px 10px;\n  border-radius: 6px;\n  font-size: 12px;\n}\n.card-body {\n  padding: 20px;\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n}\n.venue-name {\n  margin: 0 0 8px;\n  font-size: 18px;\n  font-weight: 600;\n}\n.venue-description {\n  margin: 0 0 16px;\n  font-size: 14px;\n  color: var(--text-secondary);\n  flex-grow: 1;\n}\n\n.admin-actions {\n  display: flex;\n  gap: 8px;\n  margin-bottom: 16px;\n}\n.admin-actions button {\n  border: 1px solid var(--border-color);\n  background: transparent;\n  padding: 6px 12px;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 12px;\n}\n\n.card-footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-top: 16px;\n  margin-top: auto;\n  border-top: 1px solid var(--border-color);\n}\n.price {\n  font-weight: 600;\n  font-size: 16px;\n  color: var(--primary-color);\n}\n.details-btn {\n  background: var(--primary-color);\n  color: white;\n  text-decoration: none;\n  padding: 8px 16px;\n  border-radius: 6px;\n  font-size: 14px;\n  font-weight: 500;\n}\n</style>\n"],"mappings":";;;;AAqDA,SAASA,YAAY,QAAQ,cAAc;AAC3C,SAASC,SAAS,QAAQ,YAAY,CAAC,CAAC;AACxC,SAASC,GAAG,EAAEC,SAAS,EAAEC,KAAK,QAAQ,KAAK;AAC3C,SAASC,YAAY,EAAEC,WAAW,QAAQ,aAAa,CAAC,CAAC;;;;;;;;IAEzD,MAAM;MAAEC;IAAQ,CAAC,GAAGP,YAAY,CAAC,CAAC;IAClC,MAAMQ,MAAM,GAAGP,SAAS,CAAC,CAAC,CAAC,CAAC;;IAE5B,MAAMQ,MAAM,GAAGP,GAAG,CAAC,EAAE,CAAC;IACtB,MAAMQ,OAAO,GAAGR,GAAG,CAAC,IAAI,CAAC;IACzB,MAAMS,WAAW,GAAGT,GAAG,CAAC,EAAE,CAAC;;IAE3B;IACA,MAAMU,YAAY,GAAGA,CAAA,KAAM;MACzBJ,MAAM,CAACK,IAAI,CAAC,kBAAkB,CAAC;IACjC,CAAC;IACD,MAAMC,UAAU,GAAIC,EAAE,IAAK;MACzBP,MAAM,CAACK,IAAI,CAAC,qBAAqBE,EAAE,EAAE,CAAC;IACxC,CAAC;IACD,MAAMC,YAAY,GAAG,MAAOD,EAAE,IAAK;MACjC,MAAME,aAAa,GAAGR,MAAM,CAACS,KAAK,CAACC,IAAI,CAAEC,CAAC,IAAKA,CAAC,CAACL,EAAE,KAAKA,EAAE,CAAC;MAC3D,IAAIM,OAAO,CAAC,aAAaJ,aAAa,EAAEK,IAAI,MAAM,CAAC,EAAE;QACnD,IAAI;UACF,MAAMhB,WAAW,CAACS,EAAE,CAAC;UACrBN,MAAM,CAACS,KAAK,GAAGT,MAAM,CAACS,KAAK,CAACK,MAAM,CAAEH,CAAC,IAAKA,CAAC,CAACL,EAAE,KAAKA,EAAE,CAAC;QACxD,CAAC,CAAC,OAAOS,KAAK,EAAE;UACdC,KAAK,CAAC,QAAQ,GAAGD,KAAK,CAACE,OAAO,CAAC;QACjC;MACF;IACF,CAAC;IAED,MAAMC,WAAW,GAAG,MAAOC,KAAK,IAAK;MACnC,IAAI;QACFlB,OAAO,CAACQ,KAAK,GAAG,IAAI;QACpBT,MAAM,CAACS,KAAK,GAAG,MAAMb,YAAY,CAACuB,KAAK,CAAC;MAC1C,CAAC,CAAC,OAAOJ,KAAK,EAAE;QACdK,OAAO,CAACL,KAAK,CAACA,KAAK,CAAC;MACtB,CAAC,SAAS;QACRd,OAAO,CAACQ,KAAK,GAAG,KAAK;MACvB;IACF,CAAC;IAED,IAAIY,aAAa,GAAG,IAAI;IACxB1B,KAAK,CAACO,WAAW,EAAGoB,QAAQ,IAAK;MAC/BC,YAAY,CAACF,aAAa,CAAC;MAC3BA,aAAa,GAAGG,UAAU,CAAC,MAAM;QAC/BN,WAAW,CAACI,QAAQ,CAAC;MACvB,CAAC,EAAE,GAAG,CAAC;IACT,CAAC,CAAC;IAEF5B,SAAS,CAAC,MAAM;MACdwB,WAAW,CAAC,EAAE,CAAC;IACjB,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}