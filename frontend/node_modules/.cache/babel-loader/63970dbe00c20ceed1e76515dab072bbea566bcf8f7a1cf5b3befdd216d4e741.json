{"ast":null,"code":"import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createCommentVNode as _createCommentVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"admin-edit-page\"\n};\nconst _hoisted_2 = {\n  class: \"page-header\"\n};\nconst _hoisted_3 = {\n  class: \"page-title\"\n};\nconst _hoisted_4 = {\n  class: \"content-grid\"\n};\nconst _hoisted_5 = {\n  class: \"card\"\n};\nconst _hoisted_6 = [\"src\"];\nconst _hoisted_7 = {\n  key: 1,\n  class: \"upload-placeholder\"\n};\nconst _hoisted_8 = {\n  key: 0,\n  class: \"upload-status\"\n};\nconst _hoisted_9 = {\n  class: \"card\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"header\", _hoisted_2, [_createElementVNode(\"div\", null, [_createElementVNode(\"h1\", _hoisted_3, _toDisplayString($setup.isEditMode ? \"编辑场馆\" : \"新增场馆\"), 1 /* TEXT */), _cache[0] || (_cache[0] = _createElementVNode(\"p\", {\n    class: \"page-subtitle\"\n  }, \"填写场馆信息并上传图片\", -1 /* CACHED */))]), _createVNode(_component_router_link, {\n    to: \"/venues\",\n    class: \"back-link\"\n  }, {\n    default: _withCtx(() => [...(_cache[1] || (_cache[1] = [_createTextVNode(\"返回列表 →\", -1 /* CACHED */)]))]),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", _hoisted_4, [_createCommentVNode(\" 左侧图片上传 \"), _createElementVNode(\"div\", _hoisted_5, [_cache[3] || (_cache[3] = _createElementVNode(\"h2\", {\n    class: \"card-title\"\n  }, \"场馆图片\", -1 /* CACHED */)), _createElementVNode(\"div\", {\n    class: \"image-uploader\",\n    onClick: $setup.triggerFileUpload\n  }, [$setup.imagePreview ? (_openBlock(), _createElementBlock(\"img\", {\n    key: 0,\n    src: $setup.imagePreview,\n    alt: \"场馆预览\",\n    class: \"preview-image\"\n  }, null, 8 /* PROPS */, _hoisted_6)) : (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [...(_cache[2] || (_cache[2] = [_createElementVNode(\"div\", {\n    class: \"upload-icon-wrapper\"\n  }, [_createElementVNode(\"i\", {\n    class: \"icon icon-upload\"\n  })], -1 /* CACHED */), _createElementVNode(\"p\", {\n    class: \"upload-text\"\n  }, \"点击上传图片\", -1 /* CACHED */), _createElementVNode(\"p\", {\n    class: \"upload-hint\"\n  }, \"支持 JPG, PNG 格式\", -1 /* CACHED */)]))])), _createElementVNode(\"input\", {\n    type: \"file\",\n    ref: \"fileInput\",\n    onChange: $setup.handleFileChange,\n    accept: \"image/*\",\n    style: {\n      \"display\": \"none\"\n    }\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */)]), $setup.isUploading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \"图片上传中...\")) : _createCommentVNode(\"v-if\", true)]), _createCommentVNode(\" 右侧表单 \"), _createElementVNode(\"div\", _hoisted_9, [_createVNode($setup[\"VenueForm\"], {\n    \"initial-data\": $setup.venueData,\n    \"is-loading\": $setup.isLoading,\n    \"error-message\": $setup.errorMessage,\n    onSubmit: $setup.saveVenue\n  }, null, 8 /* PROPS */, [\"initial-data\", \"is-loading\", \"error-message\"])])])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_toDisplayString","$setup","isEditMode","_createVNode","_component_router_link","to","_cache","_hoisted_4","_createCommentVNode","_hoisted_5","onClick","triggerFileUpload","imagePreview","src","alt","_hoisted_7","type","ref","onChange","handleFileChange","accept","style","isUploading","_hoisted_8","_hoisted_9","venueData","isLoading","errorMessage","onSubmit","saveVenue"],"sources":["F:\\Java_web_code\\frontend\\src\\views\\AdminVenueEdit.vue"],"sourcesContent":["<template>\n  <div class=\"admin-edit-page\">\n    <header class=\"page-header\">\n      <div>\n        <h1 class=\"page-title\">{{ isEditMode ? \"编辑场馆\" : \"新增场馆\" }}</h1>\n        <p class=\"page-subtitle\">填写场馆信息并上传图片</p>\n      </div>\n      <router-link to=\"/venues\" class=\"back-link\">返回列表 &rarr;</router-link>\n    </header>\n\n    <div class=\"content-grid\">\n      <!-- 左侧图片上传 -->\n      <div class=\"card\">\n        <h2 class=\"card-title\">场馆图片</h2>\n        <div class=\"image-uploader\" @click=\"triggerFileUpload\">\n          <img\n            v-if=\"imagePreview\"\n            :src=\"imagePreview\"\n            alt=\"场馆预览\"\n            class=\"preview-image\"\n          />\n          <div v-else class=\"upload-placeholder\">\n            <div class=\"upload-icon-wrapper\">\n              <i class=\"icon icon-upload\"></i>\n            </div>\n            <p class=\"upload-text\">点击上传图片</p>\n            <p class=\"upload-hint\">支持 JPG, PNG 格式</p>\n          </div>\n          <input\n            type=\"file\"\n            ref=\"fileInput\"\n            @change=\"handleFileChange\"\n            accept=\"image/*\"\n            style=\"display: none\"\n          />\n        </div>\n        <div v-if=\"isUploading\" class=\"upload-status\">图片上传中...</div>\n      </div>\n\n      <!-- 右侧表单 -->\n      <div class=\"card\">\n        <VenueForm\n          :initial-data=\"venueData\"\n          :is-loading=\"isLoading\"\n          :error-message=\"errorMessage\"\n          @submit=\"saveVenue\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\n// ... <script setup> 部分保持不变 ...\nimport { ref, onMounted, computed } from \"vue\";\nimport { useRoute, useRouter } from \"vue-router\";\nimport VenueForm from \"@/components/VenueForm.vue\";\nimport {\n  getVenueById,\n  createVenue,\n  updateVenue,\n  uploadImage,\n} from \"@/api/venue\";\n\nconst route = useRoute();\nconst router = useRouter();\n\nconst venueData = ref({ imageUrl: \"\" });\nconst isLoading = ref(false);\nconst errorMessage = ref(\"\");\nconst isUploading = ref(false);\nconst imagePreview = ref(\"\");\nconst fileInput = ref(null);\n\nconst isEditMode = computed(() => !!route.params.id);\nconst venueId = computed(() => route.params.id);\n\nconst triggerFileUpload = () => {\n  fileInput.value.click();\n};\nconst handleFileChange = async (event) => {\n  const file = event.target.files[0];\n  if (!file) return;\n  const reader = new FileReader();\n  reader.onload = (e) => {\n    imagePreview.value = e.target.result;\n  };\n  reader.readAsDataURL(file);\n\n  isUploading.value = true;\n  try {\n    venueData.value.imageUrl = await uploadImage(file);\n  } catch (error) {\n    errorMessage.value = \"图片上传失败: \" + error.message;\n  } finally {\n    isUploading.value = false;\n  }\n};\n\nconst saveVenue = async (formData) => {\n  isLoading.value = true;\n  errorMessage.value = \"\";\n  const finalData = { ...formData, imageUrl: venueData.value.imageUrl };\n\n  try {\n    if (isEditMode.value) {\n      await updateVenue(venueId.value, finalData);\n      alert(\"场馆更新成功！\");\n    } else {\n      await createVenue(finalData);\n      alert(\"场馆新增成功！\");\n    }\n    router.push(\"/venues\");\n  } catch (error) {\n    errorMessage.value = error.message || \"操作失败\";\n  } finally {\n    isLoading.value = false;\n  }\n};\n\nonMounted(async () => {\n  if (isEditMode.value) {\n    isLoading.value = true;\n    try {\n      const data = await getVenueById(venueId.value);\n      venueData.value = data;\n      if (data.imageUrl) {\n        imagePreview.value = data.imageUrl;\n      }\n    } catch (error) {\n      errorMessage.value = \"加载场馆数据失败\";\n    } finally {\n      isLoading.value = false;\n    }\n  }\n});\n</script>\n\n<style scoped>\n@import url(\"@/assets/icons.css\");\n.icon-upload {\n  mask-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4'%3E%3C/path%3E%3Cpolyline points='17 8 12 3 7 8'%3E%3C/polyline%3E%3Cline x1='12' y1='3' x2='12' y2='15'%3E%3C/line%3E%3C/svg%3E\");\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin-bottom: 32px;\n}\n.page-subtitle {\n  color: var(--color-text-secondary);\n  margin-top: 8px;\n}\n.back-link {\n  color: var(--color-primary);\n  text-decoration: none;\n  font-weight: 500;\n}\n\n.content-grid {\n  display: grid;\n  grid-template-columns: 320px 1fr;\n  gap: 32px;\n}\n.card {\n  background: #fff;\n  padding: 24px;\n  border-radius: var(--border-radius-lg);\n  border: 1px solid var(--color-border);\n}\n.card-title {\n  font-size: 16px;\n  font-weight: 600;\n  margin: 0 0 16px;\n}\n\n.image-uploader {\n  aspect-ratio: 1 / 1;\n  border: 2px dashed var(--color-border);\n  border-radius: var(--border-radius-lg);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n  overflow: hidden;\n  transition: border-color 0.3s;\n}\n.image-uploader:hover {\n  border-color: var(--color-primary);\n}\n.preview-image {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n.upload-placeholder {\n  text-align: center;\n}\n.upload-icon-wrapper {\n  width: 48px;\n  height: 48px;\n  border-radius: 50%;\n  background: #f8fafc;\n  color: var(--color-primary);\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  margin-bottom: 12px;\n}\n.upload-text {\n  font-weight: 500;\n  margin: 0 0 4px;\n}\n.upload-hint {\n  font-size: 12px;\n  color: var(--color-text-secondary);\n  margin: 0;\n}\n.upload-status {\n  margin-top: 10px;\n  color: var(--color-text-secondary);\n  font-size: 14px;\n}\n</style>\n"],"mappings":";;EACOA,KAAK,EAAC;AAAiB;;EAClBA,KAAK,EAAC;AAAa;;EAEnBA,KAAK,EAAC;AAAY;;EAMrBA,KAAK,EAAC;AAAc;;EAElBA,KAAK,EAAC;AAAM;;;;EASDA,KAAK,EAAC;;;;EAeIA,KAAK,EAAC;;;EAI3BA,KAAK,EAAC;AAAM;;;uBAvCrBC,mBAAA,CAgDM,OAhDNC,UAgDM,GA/CJC,mBAAA,CAMS,UANTC,UAMS,GALPD,mBAAA,CAGM,cAFJA,mBAAA,CAA8D,MAA9DE,UAA8D,EAAAC,gBAAA,CAApCC,MAAA,CAAAC,UAAU,oC,0BACpCL,mBAAA,CAAwC;IAArCH,KAAK,EAAC;EAAe,GAAC,aAAW,oB,GAEtCS,YAAA,CAAqEC,sBAAA;IAAxDC,EAAE,EAAC,SAAS;IAACX,KAAK,EAAC;;sBAAY,MAAW,KAAAY,MAAA,QAAAA,MAAA,O,iBAAX,QAAW,mB;;QAGzDT,mBAAA,CAsCM,OAtCNU,UAsCM,GArCJC,mBAAA,YAAe,EACfX,mBAAA,CAyBM,OAzBNY,UAyBM,G,0BAxBJZ,mBAAA,CAAgC;IAA5BH,KAAK,EAAC;EAAY,GAAC,MAAI,qBAC3BG,mBAAA,CAqBM;IArBDH,KAAK,EAAC,gBAAgB;IAAEgB,OAAK,EAAET,MAAA,CAAAU;MAE1BV,MAAA,CAAAW,YAAY,I,cADpBjB,mBAAA,CAKE;;IAHCkB,GAAG,EAAEZ,MAAA,CAAAW,YAAY;IAClBE,GAAG,EAAC,MAAM;IACVpB,KAAK,EAAC;wDAERC,mBAAA,CAMM,OANNoB,UAMM,OAAAT,MAAA,QAAAA,MAAA,OALJT,mBAAA,CAEM;IAFDH,KAAK,EAAC;EAAqB,IAC9BG,mBAAA,CAAgC;IAA7BH,KAAK,EAAC;EAAkB,G,oBAE7BG,mBAAA,CAAiC;IAA9BH,KAAK,EAAC;EAAa,GAAC,QAAM,oBAC7BG,mBAAA,CAAyC;IAAtCH,KAAK,EAAC;EAAa,GAAC,gBAAc,mB,OAEvCG,mBAAA,CAME;IALAmB,IAAI,EAAC,MAAM;IACXC,GAAG,EAAC,WAAW;IACdC,QAAM,EAAEjB,MAAA,CAAAkB,gBAAgB;IACzBC,MAAM,EAAC,SAAS;IAChBC,KAAqB,EAArB;MAAA;IAAA;oDAGOpB,MAAA,CAAAqB,WAAW,I,cAAtB3B,mBAAA,CAA4D,OAA5D4B,UAA4D,EAAd,UAAQ,K,qCAGxDf,mBAAA,UAAa,EACbX,mBAAA,CAOM,OAPN2B,UAOM,GANJrB,YAAA,CAKEF,MAAA;IAJC,cAAY,EAAEA,MAAA,CAAAwB,SAAS;IACvB,YAAU,EAAExB,MAAA,CAAAyB,SAAS;IACrB,eAAa,EAAEzB,MAAA,CAAA0B,YAAY;IAC3BC,QAAM,EAAE3B,MAAA,CAAA4B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}